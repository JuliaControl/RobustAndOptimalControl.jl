<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simple mixed-sensitivity H_infty design · RobustAndOptimalControl Documentation</title><meta name="title" content="Simple mixed-sensitivity H_infty design · RobustAndOptimalControl Documentation"/><meta property="og:title" content="Simple mixed-sensitivity H_infty design · RobustAndOptimalControl Documentation"/><meta property="twitter:title" content="Simple mixed-sensitivity H_infty design · RobustAndOptimalControl Documentation"/><meta name="description" content="Documentation for RobustAndOptimalControl Documentation."/><meta property="og:description" content="Documentation for RobustAndOptimalControl Documentation."/><meta property="twitter:description" content="Documentation for RobustAndOptimalControl Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">RobustAndOptimalControl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../uncertainty/">Uncertainty modeling</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Simple mixed-sensitivity <span>$H_\infty$</span> design</a><ul class="internal"><li><a class="tocitem" href="#Synthesize-the-H-infinity-optimal-controller"><span>Synthesize the H-infinity optimal controller</span></a></li><li><a class="tocitem" href="#Plot-the-specifications"><span>Plot the specifications</span></a></li><li><a class="tocitem" href="#Generate-C-code-for-the-controller"><span>Generate C-code for the controller</span></a></li><li><a class="tocitem" href="#Video"><span>Video</span></a></li></ul></li><li><a class="tocitem" href="../hinf_connection/">General <span>$H_\infty$</span> design</a></li><li><a class="tocitem" href="../lqg_disturbance/">LQG control with integral action</a></li><li><a class="tocitem" href="../cartpole/">Control design for a pendulum on a cart</a></li><li><a class="tocitem" href="../measurable_disturbance/"><span>$H_2$</span> design with a known disturbance</a></li><li><a class="tocitem" href="../similarity/">When are systems similar?</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Simple mixed-sensitivity <span>$H_\infty$</span> design</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simple mixed-sensitivity <span>$H_\infty$</span> design</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaControl/RobustAndOptimalControl.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaControl/RobustAndOptimalControl.jl/blob/master/docs/src/hinf_DC.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Mixed-sensitivity-H_\\infty-control-design"><a class="docs-heading-anchor" href="#Mixed-sensitivity-H_\\infty-control-design">Mixed-sensitivity <span>$H_\infty$</span> control design</a><a id="Mixed-sensitivity-H_\\infty-control-design-1"></a><a class="docs-heading-anchor-permalink" href="#Mixed-sensitivity-H_\\infty-control-design" title="Permalink"></a></h1><p>In this tutorial, we will design a controller for a DC-servo (electrical motor).</p><p>The servo takes a torque command as input and we are interested in controlling the angle of the output shaft. An approximate model for a DC servo, valid for low frequencies, is</p><p class="math-container">\[\tau = k ( J \ddot{\phi} + c\dot{\phi} )\]</p><p>where <span>$\tau$</span> is the torque and <span>$\phi$</span> is the angle. The parameter <span>$J$</span> denotes the inertia of the motor and load, <span>$c$</span> is a viscous friction parameter and <span>$k$</span> is a torque constant (gain). </p><p>This is a simple SISO example with a pole in the origin. Poles on the stability boundary are problematic for several numerical routines, and this tutorial demonstrates a common trick applied in these situations. </p><p>We start by defining the process model. We will use the parameter values <span>$J=1, c=0.12, k=11.2$</span> which yields the transfer function</p><p class="math-container">\[G(s) = \dfrac{k}{s(Js + c)} = \dfrac{11.2}{s^2 + 0.12s + 0}\]</p><pre><code class="language-julia hljs">using RobustAndOptimalControl, ControlSystemsBase, Plots
Gtrue = tf([11.2], [1, 0.12, 0])</code></pre><p>When designing a controller using <span>$H_\infty$</span> synthesis, we formally specify an optimization problem where the cost function is the <span>$H_\infty$</span> norm of a suitably chosen transfer function, and the optimization variable is the controller. The function <a href="../api/#RobustAndOptimalControl.hinfpartition-NTuple{4, Any}"><code>hinfpartition</code></a> helps us to build the transfer function that appears in the following <span>$H_\infty$</span> optimization problem<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><p class="math-container">\[\operatorname{minimize}_K \begin{Vmatrix}
W_S S \\
W_U KS \\
W_T T
\end{Vmatrix}_\infty\]</p><p>where <span>$K$</span> is the controller and <span>$S$</span> is the sensitivity function <span>$(1+GK)^{-1}$</span>. The transfer functions <span>$W_S$</span>, <span>$W_T$</span> and <span>$W_U$</span> are weight functions that emphasize different frequency ranges, for example, if <span>$W_S(i\omega)$</span> is large for a particular frequency <span>$\omega$</span>, then <span>$S$</span> is forced to be small at <span>$\omega$</span> in order for the <span>$H_\infty$</span> norm to be small. </p><p>In this case, we will omit the penalty on the transfer function <span>$T$</span>, and thus solve</p><p class="math-container">\[\operatorname{minimize}_K \begin{Vmatrix}
W_S S \\
W_U KS
\end{Vmatrix}_\infty\]</p><pre><code class="language-julia hljs"># Sensitivity weight function
WS = makeweight(1e5, 0.05, 0.5) |&gt; tf

# Output sensitivity weight function. Increase this value to penalize controller effort more
WU = ss(1.0)

# Complementary sensitivity weight function
WT = [] # We do not put any weight on T in this example</code></pre><p>To solve this problem, we partition the system <span>$P$</span> in a two-input, two output configuration such that  <span>$\operatorname{lft}_{l}(P,K)$</span> forms the system we want to minimize the <span>$H_\infty$</span> norm of with respect to <span>$K$</span>. To help with this partitioning, we have the function <a href="../api/#RobustAndOptimalControl.hinfpartition-NTuple{4, Any}"><code>hinfpartition</code></a>:</p><pre><code class="language-julia hljs">P = hinfpartition(Gtrue, WS, WU, WT)</code></pre><p>The object <code>P</code> will now be of type <a href="../api/#RobustAndOptimalControl.ExtendedStateSpace"><code>ExtendedStateSpace</code></a>, and represent the following <code>P</code>, with two input ports <code>w,u</code> and two output ports <code>z,y</code>:</p><pre><code class="nohighlight hljs">     ┌─────────┐
z◄───┤         │◄────w
     │    P    │
y┌───┤         │◄───┐u
 │   └─────────┘    │
 │                  │
 │      ┌───┐       │
 │      │   │       │
 └─────►│ K ├───────┘
        │   │
        └───┘</code></pre><p>The operation <code>lft(P, K)</code> forms the feedback interconnection in the diagram, and the <span>$H_\infty$</span> optimization will minimize the <span>$H_\infty$</span> norm of the transfer function from <span>$w$</span> to <span>$z$</span> with respect to <span>$K$</span>.</p><p>Before solving, we may check if the synthesis problem is feasible</p><pre><code class="language-julia hljs">hinfassumptions(P, verbose=true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>The problem is not feasible, in this case due to the integrator pole on the stability margin. We thus modify the plant description by moving the integrator pole in the origin slightly (<span>$\varepsilon$</span>) into the stable region</p><pre><code class="language-julia hljs">ε = 1e-4
G = tf([11.2], [1, 0.12]) * tf([1], [1, ε])</code></pre><p>If we now perform the assumption check again, it passes</p><pre><code class="language-julia hljs">P = hinfpartition(G, WS, WU, WT)
hinfassumptions(P)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="Synthesize-the-H-infinity-optimal-controller"><a class="docs-heading-anchor" href="#Synthesize-the-H-infinity-optimal-controller">Synthesize the H-infinity optimal controller</a><a id="Synthesize-the-H-infinity-optimal-controller-1"></a><a class="docs-heading-anchor-permalink" href="#Synthesize-the-H-infinity-optimal-controller" title="Permalink"></a></h2><p>With the problem properly defined, we may call <a href="../api/#RobustAndOptimalControl.hinfsynthesize-Union{Tuple{ExtendedStateSpace{Continuous, T}}, Tuple{T}} where T"><code>hinfsynthesize</code></a> to solve it. The result is the controller <span>$K$</span> and a performance index <span>$\gamma$</span>:</p><pre><code class="language-julia hljs">K, γ = hinfsynthesize(P, γrel=1.05)
γ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3.1761684134884085</code></pre><p>The achieved performance level is indicated by <span>$\gamma$</span>, this number is the norm we are optimizing (the <span>$H_\infty$</span> norm) and it should be as low as possible.</p><div class="admonition is-info"><header class="admonition-header">$H_2$ optimization</header><div class="admonition-body"><p>If we instead of <a href="../api/#RobustAndOptimalControl.hinfsynthesize-Union{Tuple{ExtendedStateSpace{Continuous, T}}, Tuple{T}} where T"><code>hinfsynthesize</code></a> had called <a href="../api/#RobustAndOptimalControl.h2synthesize"><code>h2synthesize</code></a>, we had solved the same optimization problem, but under the <span>$H_2$</span> norm instead of the <span>$H_\infty$</span> norm.</p></div></div><p>For verification purposes, we may extract some transfer functions defining common sensitivity functions:</p><pre><code class="language-julia hljs">Pcl, S, KS, T = hinfsignals(P, G, K)</code></pre><p>We may also verify that the closed-loop system has <span>$H_\infty$</span> norm <span>$\gamma$</span></p><pre><code class="language-julia hljs">Pcl == lft(P, K)
isapprox(hinfnorm2(Pcl)[1], γ, rtol=1e-5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="Plot-the-specifications"><a class="docs-heading-anchor" href="#Plot-the-specifications">Plot the specifications</a><a id="Plot-the-specifications-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-specifications" title="Permalink"></a></h2><p>The resulting sensitivity functions can be plotted together with the inverse weighting functions multiplied by <span>$\gamma$</span> to get a feeling for where the constraints are active. </p><pre><code class="language-julia hljs">specificationplot([S, KS, T], [WS, WU, WT], γ)</code></pre><img src="b19dd268.svg" alt="Example block output"/><p>In this case, the noise amplification constraint is active between about <span>$10^0 - 10^{1}$</span> rad/s and the sensitivity function is pushed down for lower frequencies. In this case, the complimentary sensitivity function <span>$T = (1+GK)^{-1}GK$</span> has desireable properties without us specifying and penalizing this function in the optimization problem. If we would like to push this function down at certain frequencies, we may specify a non-empty weight <span>$W_T$</span> as well. The transfer function <span>$KS$</span> (labeled <code>CS</code> in the figure) has some natural roll-off for high frequencies. If we want steeper roll-off (more filtering), we could change the weight function <code>WU</code> to a transfer function with high gain for high frequencies.</p><h2 id="Generate-C-code-for-the-controller"><a class="docs-heading-anchor" href="#Generate-C-code-for-the-controller">Generate C-code for the controller</a><a id="Generate-C-code-for-the-controller-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-C-code-for-the-controller" title="Permalink"></a></h2><p>The controller <code>K</code> is given in the form of a statespace system. The package <a href="https://github.com/JuliaControl/SymbolicControlSystems.jl">SymbolicControlSystemsBase.jl</a> can be used to generate C-code for such systems, making it easy to implement the controller.</p><h2 id="Video"><a class="docs-heading-anchor" href="#Video">Video</a><a id="Video-1"></a><a class="docs-heading-anchor-permalink" href="#Video" title="Permalink"></a></h2><p>For a video tutorial using this functionality, see </p><iframe style="height: 315px; width: 560px" src="https://www.youtube.com/embed/huYRrn--AKc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>For ill-conditioned MIMO plants, the <span>$S, KS, T$</span> weighting may result in controllers that &quot;invert&quot; the plant, which may result in poor robustness. For such systems, penalizing <span>$GS$</span> and <span>$T$</span> may be more appropriate. Ref: &quot;Inverting and noninverting H∞ controllers&quot;, Urs Christen, Hans Geering.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../uncertainty/">« Uncertainty modeling</a><a class="docs-footer-nextpage" href="../hinf_connection/">General <span>$H_\infty$</span> design »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 8 January 2025 14:04">Wednesday 8 January 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
