<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · RobustAndOptimalControl Documentation</title><meta name="title" content="Home · RobustAndOptimalControl Documentation"/><meta property="og:title" content="Home · RobustAndOptimalControl Documentation"/><meta property="twitter:title" content="Home · RobustAndOptimalControl Documentation"/><meta name="description" content="Documentation for RobustAndOptimalControl Documentation."/><meta property="og:description" content="Documentation for RobustAndOptimalControl Documentation."/><meta property="twitter:description" content="Documentation for RobustAndOptimalControl Documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>RobustAndOptimalControl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Robust-control"><span>Robust control</span></a></li><li><a class="tocitem" href="#Package-highlights"><span>Package highlights</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Named-systems"><span>Named systems</span></a></li><li><a class="tocitem" href="#Connecting-systems-together"><span>Connecting systems together</span></a></li><li><a class="tocitem" href="#Model-augmentation"><span>Model augmentation</span></a></li><li><a class="tocitem" href="#H_\\infty-and-H_2-design"><span><span>$H_\infty$</span> and <span>$H_2$</span> design</span></a></li><li><a class="tocitem" href="#LQG-design"><span>LQG design</span></a></li><li><a class="tocitem" href="#System-analysis"><span>System analysis</span></a></li><li><a class="tocitem" href="#Structured-singular-value-and-diskmargin"><span>Structured singular value and diskmargin</span></a></li><li><a class="tocitem" href="#Closed-loop-analysis"><span>Closed-loop analysis</span></a></li><li><a class="tocitem" href="#Model-reduction"><span>Model reduction</span></a></li><li><a class="tocitem" href="#Model-transformations"><span>Model transformations</span></a></li></ul></li><li><a class="tocitem" href="uncertainty/">Uncertainty modeling</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="hinf_DC/">Simple mixed-sensitivity <span>$H_\infty$</span> design</a></li><li><a class="tocitem" href="hinf_connection/">General <span>$H_\infty$</span> design</a></li><li><a class="tocitem" href="lqg_disturbance/">LQG control with integral action</a></li><li><a class="tocitem" href="cartpole/">Control design for a pendulum on a cart</a></li><li><a class="tocitem" href="measurable_disturbance/"><span>$H_2$</span> design with a known disturbance</a></li><li><a class="tocitem" href="similarity/">When are systems similar?</a></li></ul></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaControl/RobustAndOptimalControl.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaControl/RobustAndOptimalControl.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p style="text-align:center">

<img src="https://avatars.githubusercontent.com/u/10605979?s=400&u=7b2efdd404c4db3b3f067f04c305d40c025a8961&v=4" alt="JuliaControl logo">

<br> 

<a class="github-button" href="https://github.com/JuliaControl/RobustAndOptimalControl.jl" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="octicon-star" data-show-count="true" aria-label="Star JuliaControl/RobustAndOptimalControl.jl on GitHub">Star</a>

<script async defer src="https://buttons.github.io/buttons.js"></script>
</p> <pre><code class="language-setup hljs">using RobustAndOptimalControl
using ControlSystemsBase </code></pre><h1 id="RobustAndOptimalControl.jl"><a class="docs-heading-anchor" href="#RobustAndOptimalControl.jl">RobustAndOptimalControl.jl</a><a id="RobustAndOptimalControl.jl-1"></a><a class="docs-heading-anchor-permalink" href="#RobustAndOptimalControl.jl" title="Permalink"></a></h1><p>This package is an extension to <a href="https://github.com/JuliaControl/ControlSystems.jl">ControlSystems.jl</a> that provides methods for robust and optimal analysis and synthesis of linear control systems.</p><h2 id="Robust-control"><a class="docs-heading-anchor" href="#Robust-control">Robust control</a><a id="Robust-control-1"></a><a class="docs-heading-anchor-permalink" href="#Robust-control" title="Permalink"></a></h2><p>Robust control refers to a set of design and analysis methods that attempt to guarantee stability and performance of a closed-loop control system in the presence of uncertainties, such as plant model mismatch and unknown disturbances.</p><p>From classical control, we get robustness measures such as gain and phase margins. These provide a quick and intuitive way to assess robustness of single-input, single-output systems, but also have a number of downsides, such as optimism in the presence of simultaneous gain and phase variations as well as limited applicability for MIMO systems.</p><p>More generally applicable measures of robustness include analysis of sensitivity functions, notably the peaks of the sensitivity function</p><p class="math-container">\[S(s) = (I + P(s)C(s))^{-1}\]</p><p>and the complementary sensitivity function</p><p class="math-container">\[T(s) = I - S(s) = (I + P(s)C(s))^{-1}P(s)C(s)\]</p><p>A modern robustness measure is the <a href="api/#RobustAndOptimalControl.diskmargin"><code>diskmargin</code></a>, that analyses the robustness of a SISO or MIMO system to simultaneous gain and phase variations.</p><p>In the presence of structured uncertainty, such as parameter uncertainty or other explicitly modeled uncertainty, the structured singular value (often referred to as <span>$\mu$</span>), provides a way to analyze robustness with respect to the modeled uncertainty.</p><h2 id="Package-highlights"><a class="docs-heading-anchor" href="#Package-highlights">Package highlights</a><a id="Package-highlights-1"></a><a class="docs-heading-anchor-permalink" href="#Package-highlights" title="Permalink"></a></h2><ul><li>Named statespace systems (<a href="api/#RobustAndOptimalControl.named_ss-Tuple{AbstractStateSpace, Any}"><code>named_ss</code></a>) where states, inputs and outputs are accessible by names rather than indices. This also facilitates creating complicated feedback interconnections using <a href="api/#RobustAndOptimalControl.connect-Tuple{Any, AbstractVector{&lt;:Pair}}"><code>connect</code></a>.</li><li>An interface to <a href="https://github.com/andreasvarga/DescriptorSystems.jl">DescriptorSystems.jl</a>. Call <a href="api/#DescriptorSystems.dss-Tuple{AbstractStateSpace}"><code>dss</code></a> on a statespace system to get a descriptor system. We also forward some methods to implementations in DescriptorSystems.</li><li>Robust/optimal design methods such as <span>$H_{\infty}$</span>, <span>$H_{2}$</span>, LQG and Glover-McFarlane.</li><li>Robustness-related metrics such as <a href="api/#RobustAndOptimalControl.nugap"><code>nugap</code></a> (<span>$\nu$</span>-gap), <a href="api/#RobustAndOptimalControl.ncfmargin-Tuple{Any, Any}"><code>ncfmargin</code></a>, <a href="api/#RobustAndOptimalControl.diskmargin"><code>diskmargin</code></a> etc.</li><li>Uncertainty modeling with the <span>$M\Delta$</span> framework (and more). Analysis methods for this framework are still limited.</li><li>Model augmentation.</li><li>An <a href="api/#RobustAndOptimalControl.ExtendedStateSpace"><code>ExtendedStateSpace</code></a> type that represents a partitioned statespace system <span>$w,u \rightarrow z,y$</span>.</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="nohighlight hljs">pkg&gt; add RobustAndOptimalControl</code></pre><h2 id="Named-systems"><a class="docs-heading-anchor" href="#Named-systems">Named systems</a><a id="Named-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Named-systems" title="Permalink"></a></h2><p>Named systems can be created with <a href="api/#RobustAndOptimalControl.named_ss-Tuple{AbstractStateSpace, Any}"><code>named_ss</code></a> and indexed with their names, e.g.,</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; G = ssrand(2,2,2);</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `ssrand` not defined in `Main`
Suggestion: check for spelling errors or missing imports.
Hint: a global variable of this name also exists in ControlSystemsBase.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; s1 = named_ss(G, x = :x, u = [:u_temp, :u_current]) # Create a named system</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `named_ss` not defined in `Main`
Suggestion: check for spelling errors or missing imports.
Hint: a global variable of this name also exists in RobustAndOptimalControl.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; s1[:y1, :u_temp] # Access inputs and outputs using their names</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `s1` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code></pre><p>but also using incomplete names, e.g., if <code>G</code> contains outputs <code>:y1, :y2, :y3, :z1, :z2</code>, the following retrieves the three outputs that has the prefix <code>:y</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; s1[:y, :] # Prefix matching is used if no exact match is found.</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `s1` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code></pre><p>See the example under <a href="#Connecting-systems-together">Connecting systems together</a> below as well as <a href="https://github.com/JuliaControl/RobustAndOptimalControl.jl/blob/master/examples/complicated_feedback.jl">complicated-feedback example</a>.</p><h2 id="Connecting-systems-together"><a class="docs-heading-anchor" href="#Connecting-systems-together">Connecting systems together</a><a id="Connecting-systems-together-1"></a><a class="docs-heading-anchor-permalink" href="#Connecting-systems-together" title="Permalink"></a></h2><p>Advanced interconnected systems can be created using the function <a href="api/#RobustAndOptimalControl.connect-Tuple{Any, AbstractVector{&lt;:Pair}}"><code>connect</code></a>.  See the following example, as well as <a href="https://github.com/JuliaControl/RobustAndOptimalControl.jl/blob/master/examples/complicated_feedback.jl">complicated-feedback example</a>.</p><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>The following complicated feedback interconnection</p><pre><code class="nohighlight hljs">                 yF
              ┌────────────────────────────────┐
              │                                │
    ┌───────┐ │  ┌───────┐ yR   ┌─────────┐    │    ┌───────┐
uF  │       │ │  │       ├──────►         │ yC │  uP│       │    yP
────►   F   ├─┴──►   R   │      │    C    ├────+────►   P   ├────┬────►
    │       │    │       │   ┌──►         │         │       │    │
    └───────┘    └───────┘   │  └─────────┘         └───────┘    │
                             │                                   │
                             └───────────────────────────────────┘</code></pre><p>can be created by</p><pre><code class="language-julia hljs">F = named_ss(ssrand(1, 1, 2, proper=true), x=:xF, u=:uF, y=:yF)
R = named_ss(ssrand(1, 1, 2, proper=true), x=:xR, u=:uR, y=:yR)
C = named_ss(ssrand(1, 1, 2, proper=true), x=:xC, u=:uC, y=:yC)
P = named_ss(ssrand(1, 1, 3, proper=true), x=:xP, u=:uP, y=:yP)

addP = sumblock(&quot;uP = yF + yC&quot;) # Sum node before P
addC = sumblock(&quot;uC = yR - yP&quot;) # Sum node before C (drawn as two arrows into C in the diagram)

connections = [
    :yP =&gt; :yP # Output to input
    :uP =&gt; :uP # addP&#39;s output is called the same as P&#39;s input
    :yC =&gt; :yC
    :yF =&gt; :yF
    :yF =&gt; :uR
    :uC =&gt; :uC
    :yR =&gt; :yR
]
external_inputs  = [:uF]
external_outputs = [:yP] # Optional, if not provided, all outputs are considered external

G = connect([F, R, C, P, addP, addC], connections; external_inputs, external_outputs)</code></pre><p>If an external input is to be connected to multiple points, use a <code>splitter</code> to split up the signal into a set of unique names which are then used in the connections.</p><h2 id="Model-augmentation"><a class="docs-heading-anchor" href="#Model-augmentation">Model augmentation</a><a id="Model-augmentation-1"></a><a class="docs-heading-anchor-permalink" href="#Model-augmentation" title="Permalink"></a></h2><p>Add disturbance and performance models to your system model.</p><ul><li><a href="api/#RobustAndOptimalControl.add_disturbance-Tuple{AbstractStateSpace, AbstractMatrix, AbstractMatrix}"><code>add_disturbance</code></a></li><li><a href="api/#RobustAndOptimalControl.add_measurement_disturbance-Tuple{AbstractStateSpace, AbstractMatrix, AbstractMatrix}"><code>add_measurement_disturbance</code></a></li><li><a href="api/#RobustAndOptimalControl.add_input_differentiator"><code>add_input_differentiator</code></a></li><li><a href="api/#RobustAndOptimalControl.add_output_differentiator"><code>add_output_differentiator</code></a></li><li><a href="api/#RobustAndOptimalControl.add_input_integrator"><code>add_input_integrator</code></a></li><li><a href="api/#RobustAndOptimalControl.add_output_integrator"><code>add_output_integrator</code></a></li><li><a href="api/#RobustAndOptimalControl.add_low_frequency_disturbance"><code>add_low_frequency_disturbance</code></a></li><li><a href="api/#RobustAndOptimalControl.add_resonant_disturbance-Tuple{AbstractStateSpace, Any, Any, AbstractArray}"><code>add_resonant_disturbance</code></a></li></ul><h2 id="H_\\infty-and-H_2-design"><a class="docs-heading-anchor" href="#H_\\infty-and-H_2-design"><span>$H_\infty$</span> and <span>$H_2$</span> design</a><a id="H_\\infty-and-H_2-design-1"></a><a class="docs-heading-anchor-permalink" href="#H_\\infty-and-H_2-design" title="Permalink"></a></h2><p>Examples are available in the <a href="https://github.com/JuliaControl/RobustAndOptimalControl.jl/tree/master/examples">example folder</a>.</p><ul><li><a href="api/#RobustAndOptimalControl.hinfsynthesize-Union{Tuple{ExtendedStateSpace{Continuous, T}}, Tuple{T}} where T"><code>hinfsynthesize</code></a></li><li><a href="api/#RobustAndOptimalControl.h2synthesize"><code>h2synthesize</code></a></li><li><a href="api/#RobustAndOptimalControl.hinfpartition-NTuple{4, Any}"><code>hinfpartition</code></a></li><li><a href="api/#RobustAndOptimalControl.hinfassumptions-Tuple{ExtendedStateSpace}"><code>hinfassumptions</code></a></li><li><a href="api/#RobustAndOptimalControl.specificationplot"><code>specificationplot</code></a></li><li><a href="api/#RobustAndOptimalControl.glover_mcfarlane"><code>glover_mcfarlane</code></a></li><li><a href="api/#RobustAndOptimalControl.glover_mcfarlane_2dof"><code>glover_mcfarlane_2dof</code></a></li><li><a href="api/#RobustAndOptimalControl.hanus-Tuple{Any}"><code>hanus</code></a></li></ul><h3 id="Example:-Glover-McFarlane-design"><a class="docs-heading-anchor" href="#Example:-Glover-McFarlane-design">Example: Glover McFarlane design</a><a id="Example:-Glover-McFarlane-design-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Glover-McFarlane-design" title="Permalink"></a></h3><p>This example will design a robust controller using the Glover-McFarlane method. This method requires the user to perform an initial loop-shaping design, i.e., by tuning a standard PI controller etc. The <a href="api/#RobustAndOptimalControl.glover_mcfarlane"><code>glover_mcfarlane</code></a> method then takes the loop-shaping controller and the plant model and returns a robustified controller. This is example 9.3 from Skogestad, &quot;Multivariable Feedback Control: Analysis and Design&quot;.</p><pre><code class="language-julia hljs">using RobustAndOptimalControl, ControlSystemsBase, Plots, Test
G = tf(200, [10, 1])*tf(1, [0.05, 1])^2     |&gt; ss # Plant model
Gd = tf(100, [10, 1])                       |&gt; ss # Disturbance model
W1 = tf([1, 2], [1, 1e-6])                  |&gt; ss # Loop-shaping controller
K, γ, info = glover_mcfarlane(G, 1.1; W1)         # K is robustified controller
@test info.γmin ≈ 2.34 atol=0.005
Gcl = extended_gangoffour(G, K) # Form closed-loop system

fig1 = bodeplot([G, info.Gs, G*K], lab=[&quot;G&quot; &quot;&quot; &quot;Initial GK&quot; &quot;&quot; &quot;Robustified GK&quot;])
fig2 = bodeplot(Gcl, lab=[&quot;S&quot; &quot;KS&quot; &quot;PS&quot; &quot;T&quot;], plotphase=false) # Plot gang of four

# Simulate the response to a disturbance (Gd*feedback(1, G*K) = Gd*S is the closed-loop transfer function from an additive output disturbance)
fig3 = plot(step(Gd*feedback(1, info.Gs), 3), lab=&quot;Initial controller&quot;)
plot!(step(Gd*feedback(1, G*K), 3), lab=&quot;Robustified controller&quot;)
fig4 = nyquistplot([info.Gs, G*K], ylims=(-2,1), xlims=(-2, 1),
    Ms_circles = 1.5,
    lab = [&quot;Initial controller&quot; &quot;Robustified controller&quot;],
    title = &quot;Loop transfers with and without robustified controller&quot;
)
plot(fig1, fig2, fig3, fig4, titlefontsize=9, labelfontsize=9, size=(800, 640))</code></pre><img src="index-7bc21e58.svg" alt="Example block output"/><h4 id="Example-of-controller-reduction:"><a class="docs-heading-anchor" href="#Example-of-controller-reduction:">Example of controller reduction:</a><a id="Example-of-controller-reduction:-1"></a><a class="docs-heading-anchor-permalink" href="#Example-of-controller-reduction:" title="Permalink"></a></h4><p>The order of the controller designed above can be reduced maintaining at least 2/3 of the robustness margin like this</p><pre><code class="language-julia hljs">e,_ = ncfmargin(info.Gs, info.Ks)
Kr, hs, infor = baltrunc_coprime(info.Ks, n=info.Ks.nx)
n = findlast(RobustAndOptimalControl.error_bound(hs) .&gt; 2e/3) # 2/3 e sets the robustness margin
Ksr, hs, infor = baltrunc_coprime(info.Ks; n)
@test ncfmargin(info.Gs, Ksr)[1] &gt;= 2/3 * e
Kr = W1*Ksr
bodeplot([G*K, G*Kr], lab=[&quot;L original&quot; &quot;&quot; &quot;L Reduced&quot; &quot;&quot;])</code></pre><img src="index-7127ebbc.svg" alt="Example block output"/><p>This gives a final controller <code>Kr</code> of order 2 instead of order 5, but a very similar robustness margin. You may also call</p><pre><code class="language-julia hljs">controller_reduction_plot(info.Gs, info.Ks)</code></pre><img src="index-4b317be3.svg" alt="Example block output"/><p>to help you select the controller order.</p><h3 id="Example:-Glover-McFarlane-2-dof-design"><a class="docs-heading-anchor" href="#Example:-Glover-McFarlane-2-dof-design">Example: Glover McFarlane 2-dof design</a><a id="Example:-Glover-McFarlane-2-dof-design-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Glover-McFarlane-2-dof-design" title="Permalink"></a></h3><p>In this example, we design a 2 degree-of-freedom controller using the Glover McFarlane method. This design method requires you to specify both a loop-shaping controller as well as a reference model. It&#39;s usually a good idea to let the reference model have the same number of poles as the system that is being controlled in order not not differentiate the references and introduce non-robustness.</p><pre><code class="language-julia hljs">using RobustAndOptimalControl, ControlSystemsBase, Plots
P = tf([1, 5], [1, 2, 10]) # Plant
W1 = tf(1,[1, 0]) |&gt; ss    # Loop shaping controller

Tref = tf(1, [1, 1])^2 |&gt; ss # Reference model of same order as P

K1dof, γ1, info1 = glover_mcfarlane(ss(P), 1.1; W1)
K2dof, γ2, info2 = glover_mcfarlane_2dof(ss(P), Tref, 1.1, 1.1; W1)

G1 = feedback(P*K1dof)
G2 = info2.Gcl

w = exp10.(LinRange(-2, 2, 200))
fig1 = bodeplot(info2.K1, w, lab=&quot;Feedforward filter&quot;)
fig2 = plot([step(G1, 15), step(G2, 15), step(Tref, 15)], lab=[&quot;1-DOF&quot; &quot;2-DOF&quot; &quot;Tref&quot;])
plot(fig1, fig2)</code></pre><img src="index-6ce879aa.svg" alt="Example block output"/><h2 id="LQG-design"><a class="docs-heading-anchor" href="#LQG-design">LQG design</a><a id="LQG-design-1"></a><a class="docs-heading-anchor-permalink" href="#LQG-design" title="Permalink"></a></h2><p>The main functionality for LQG design is exposed through <a href="api/#RobustAndOptimalControl.LQGProblem"><code>LQGProblem</code></a>. See the docstring for an example.</p><p>A video tutorial on how to use the LQG interface is available here:</p><iframe style="height: 315px; width: 560px" src="https://www.youtube.com/embed/NuAxN1mGCPs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h2 id="System-analysis"><a class="docs-heading-anchor" href="#System-analysis">System analysis</a><a id="System-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#System-analysis" title="Permalink"></a></h2><ul><li><a href="api/#RobustAndOptimalControl.hinfnorm2-Tuple{LTISystem}"><code>hinfnorm2</code></a></li><li><a href="@ref"><code>linfnorm2</code></a></li><li><a href="api/#RobustAndOptimalControl.hankelnorm-Tuple{LTISystem}"><code>hankelnorm</code></a></li><li><a href="api/#RobustAndOptimalControl.h2norm-Tuple{LTISystem}"><code>h2norm</code></a></li><li><a href="api/#RobustAndOptimalControl.nugap"><code>nugap</code></a></li><li><a href="api/#RobustAndOptimalControl.ncfmargin-Tuple{Any, Any}"><code>ncfmargin</code></a></li><li><a href="api/#RobustAndOptimalControl.robstab-Tuple{UncertainSS, Vararg{Any}}"><code>robstab</code></a></li><li><a href="api/#RobustAndOptimalControl.ispassive-Tuple{Any}"><code>ispassive</code></a></li><li><a href="api/#RobustAndOptimalControl.passivity_index-Tuple{Any}"><code>passivity_index</code></a></li><li><a href="api/#RobustAndOptimalControl.passivityplot"><code>passivityplot</code></a></li></ul><p>See also <a href="#Structured-singular-value-and-diskmargin">Structured singular value and diskmargin</a> below</p><h2 id="Structured-singular-value-and-diskmargin"><a class="docs-heading-anchor" href="#Structured-singular-value-and-diskmargin">Structured singular value and diskmargin</a><a id="Structured-singular-value-and-diskmargin-1"></a><a class="docs-heading-anchor-permalink" href="#Structured-singular-value-and-diskmargin" title="Permalink"></a></h2><ul><li><a href="api/#RobustAndOptimalControl.structured_singular_value-Tuple{LTISystem, AbstractVector}"><code>structured_singular_value</code></a>. Note, this only handles diagonal complex perturbations at the moment.</li><li><a href="api/#RobustAndOptimalControl.muplot"><code>muplot</code></a></li><li><a href="api/#RobustAndOptimalControl.diskmargin"><code>diskmargin</code></a></li><li><a href="api/#RobustAndOptimalControl.loop_diskmargin-Tuple{LTISystem, LTISystem, Vararg{Any}}"><code>loop_diskmargin</code></a></li><li><a href="api/#RobustAndOptimalControl.sim_diskmargin"><code>sim_diskmargin</code></a></li><li><a href="api/#RobustAndOptimalControl.loop_scale"><code>loop_scale</code></a></li><li><a href="api/#RobustAndOptimalControl.loop_scaling"><code>loop_scaling</code></a></li></ul><p>A video tutorial on how to perform robustness analysis using the diskmargin is available <a href="https://youtu.be/gIsa93GvPbg">here</a>.</p><h3 id="Diskmargin-example"><a class="docs-heading-anchor" href="#Diskmargin-example">Diskmargin example</a><a id="Diskmargin-example-1"></a><a class="docs-heading-anchor-permalink" href="#Diskmargin-example" title="Permalink"></a></h3><p>The diskmargin can be visualized in several ways, as a region of allowed simultaneous gain and phase variations:</p><pre><code class="language-julia hljs">using RobustAndOptimalControl, ControlSystemsBase, Plots
L = tf(25, [1,10,10,10])
dm = diskmargin(L, 0)
plot(dm) # Plot the disk margin to illustrate maximum allowed simultaneous gain and phase variations.</code></pre><img src="index-eaaa9380.svg" alt="Example block output"/><p>As a Nyquist exclusion disk:</p><pre><code class="language-julia hljs">nyquistplot(L)
plot!(dm, nyquist=true) # plot a nyquist exclusion disk. The Nyquist curve will be tangent to this disk at `dm.ω0`
nyquistplot!(dm.f0*L, lab=&quot;perturbed&quot;) # If we perturb the system with the worst-case perturbation `f0`, the curve will pass through the critical point -1.</code></pre><img src="index-f4664c75.svg" alt="Example block output"/><p>And as a frequency-dependent margin</p><pre><code class="language-julia hljs">w = exp10.(LinRange(-2, 2, 500))
dms = diskmargin(L, 0, w)
plot(dms)</code></pre><img src="index-915a854d.svg" alt="Example block output"/><p>We can also visualize the plane of complex perturbations that are allowed to be simultaneously applied to the system:</p><pre><code class="language-julia hljs">gainphaseplot(L)</code></pre><img src="index-ad93b9e1.svg" alt="Example block output"/><p>The green regions are stable perturbations while red regions are unstable. The diskmargin is the largest disk that can be placed entirely inside the green area. The center of the disk is determined by the skew of the diskmargin. The classical gain margin is the length of the green area along the x-axis starting at the point 1, while the classical phase margin is the length of the green area along the unit circle starting a the point 1.</p><h2 id="Closed-loop-analysis"><a class="docs-heading-anchor" href="#Closed-loop-analysis">Closed-loop analysis</a><a id="Closed-loop-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Closed-loop-analysis" title="Permalink"></a></h2><ul><li><a href="api/#RobustAndOptimalControl.ncfmargin-Tuple{Any, Any}"><code>ncfmargin</code></a></li><li><a href="https://juliacontrol.github.io/ControlSystems.jl/stable/examples/analysis/#Sensitivity-analysis">Sensitivity analysis</a></li></ul><p>A video tutorial on how to perform closed-loop analysis is available <a href="https://youtu.be/gIsa93GvPbg">here</a>.</p><h2 id="Model-reduction"><a class="docs-heading-anchor" href="#Model-reduction">Model reduction</a><a id="Model-reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Model-reduction" title="Permalink"></a></h2><ul><li><a href="api/#RobustAndOptimalControl.baltrunc2-Tuple{LTISystem}"><code>baltrunc2</code></a></li><li><a href="api/#RobustAndOptimalControl.frequency_weighted_reduction"><code>frequency_weighted_reduction</code></a></li><li><a href="@ref"><code>stab_unstab</code></a></li><li><a href="api/#RobustAndOptimalControl.baltrunc_unstab"><code>baltrunc_unstab</code></a></li><li><a href="api/#RobustAndOptimalControl.baltrunc_coprime-Union{Tuple{Any}, Tuple{F}, Tuple{Any, Any}} where F"><code>baltrunc_coprime</code></a></li><li><a href="api/#RobustAndOptimalControl.controller_reduction"><code>controller_reduction</code></a></li><li><a href="@ref"><code>RobustAndOptimalControl.error_bound</code></a></li><li><a href="api/#RobustAndOptimalControl.controller_reduction_plot"><code>controller_reduction_plot</code></a></li></ul><h2 id="Model-transformations"><a class="docs-heading-anchor" href="#Model-transformations">Model transformations</a><a id="Model-transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Model-transformations" title="Permalink"></a></h2><ul><li><a href="api/#RobustAndOptimalControl.modal_form-Tuple{Any}"><code>modal_form</code></a></li><li><a href="api/#RobustAndOptimalControl.schur_form-Tuple{Any}"><code>schur_form</code></a></li><li><a href="api/#RobustAndOptimalControl.hess_form-Tuple{Any}"><code>hess_form</code></a></li><li><a href="api/#RobustAndOptimalControl.frequency_separation-Tuple{Any, Any}"><code>frequency_separation</code></a></li><li><a href="@ref"><code>RobustAndOptimalControl.blockdiagonalize</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="uncertainty/">Uncertainty modeling »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 22 July 2025 12:02">Tuesday 22 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
